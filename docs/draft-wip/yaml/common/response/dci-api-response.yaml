openapi: 3.0.3
info:
  title: Details of API to be developed as interoperability between registry
  description: |-
    TODO.

    _TODO_
  version: 0.0.1

servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/ahi-dev-dc/APIDoc/0.0.1
  - description: Gateway endpoint
    url: https://localhost:8081/
tags:
  - name: Authorization API
    description: 'Authorization API' 
  - name: e-KYC API
    description: 'List of APIs to validate and take consent of beneficiaries from the National ID system' 
  - name: Search API
    description: '' 
  - name: Voucher creating API 
    description: ''
  - name: Voucher Issuance to Beneficiary
    description: ''
  - name: Eligibility determination API 
    description: ''
paths:
  /v1/auth:
    post:
      tags:
        - Authorization API
      summary: 'Generage token using client id and secret'
      description: '' 
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/x-hmac"
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
      requestBody:
        description: Search request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthRequest'     
        required: true
      responses:
        '102':
          description: Processing 
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/login:
    post:
      tags:
        - Authorization API
      summary: 'Generage token for user with his credentials and spmis client id and secret'
      description: '' 
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/x-hmac"
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
      requestBody:
        description: Search request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'     
        required: true
      responses:
        '102':
          description: Processing 
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/sendotp:
    post:
      tags:
        - e-KYC API
      summary: 'Generate OTP using national id'
      description: Generate OTP using national id
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/x-hmac"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
        - $ref: '#/components/parameters/x-async'
        - $ref: '#/components/parameters/x-callbackendpoint'
      requestBody:
        description: Search request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendOTPRequest'     
        required: true
      responses:
        '102':
          description: Processing 
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/validateOTP:
    post:
      tags:
        - e-KYC API
      summary: Validate OTP which was generated with national id
      description: '' 
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/x-hmac"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
      requestBody:
        description: Search request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ValidateOTPRequest'     
        required: true
      responses:
        '102':
          description: Processing 
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/search:
    post:
      tags:
        - Search API
      summary: To perform search operation in registry
      description: The Search operation perfromed for registry 
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/x-hmac"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
        - $ref: '#/components/parameters/x-async'
        - $ref: '#/components/parameters/x-callbackendpoint'
      requestBody:
        description: Search request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRequest'     
        required: true
      responses:
        '102':
          description: Processing 
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/on-search:
    post:
      tags:
        - Search API 
      summary: Search request call back, if callback URL empty then save response at server end respond with data when requested
      description: The requester will pass information submitted in search and if response prepared then it will send content
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
      requestBody:
        description: Search request
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRequest'     
        required: true
      responses:
        '102':
          description: Processing 
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/evoucher/generate:
    post:
      tags:
        - Voucher creating API 
      summary: This API will create request to generate E-Voucher , this will be async call to get voucher details SP system will require to make call of /evoucher/on-generate
      description: '' 
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/x-hmac"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
        - $ref: '#/components/parameters/x-async'
        - $ref: '#/components/parameters/x-callbackendpoint'
      requestBody:
        description: Request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VoucherGenerateRequest'     
        required: true
      responses:
        '202':
          description: OK
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/evoucher/on-generate:
    post:
      tags:
        - Voucher creating API
      summary: This API will respond with generated voucher details
      description: The requester will pass information submitted in /evoucher/generate 
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
      requestBody:
        description: Request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VoucherGenerateRequest'     
        required: true
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VoucherGenerateResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/evoucher/issue:
    post:
      tags:
        - Voucher Issuance to Beneficiary
      summary: This API will process to issue e-voucher to benificiery
      description: '' 
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/x-hmac"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
        - $ref: '#/components/parameters/x-async'
        - $ref: '#/components/parameters/x-callbackendpoint'
      requestBody:
        description: Request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VoucherIssueRequest'     
        required: true
      responses:
        '202':
          description: OK
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/evoucher/on-issue:
    post:
      tags:
        - Voucher Issuance to Beneficiary
      summary: This API will respond with information of issued voucher to benificiery
      description: The requester will pass information submitted in /evoucher/issue
      parameters:
        - $ref: "#/components/parameters/version"
        - $ref: "#/components/parameters/authorization"
        - $ref: '#/components/parameters/x-registry-type'
        - $ref: '#/components/parameters/x-message-id'
        - $ref: '#/components/parameters/x-timestamp'
        - $ref: '#/components/parameters/x-sender-id'
      requestBody:
        description: Request body
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VoucherIssueRequest'     
        required: true
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VoucherIssueResponse'          
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
      security:
        - spmis_auth:
            - read:search
  /v1/eligibility-determination:
    get:
      tags:
        - Eligibility determination API 
      summary: Get list of eligibility determination supported by registry
      description: ''
      operationId: ''
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema: 
                type: array
                items:
                  $ref: '#/components/schemas/SupportedEligibility'          
      security:
        - spmis_auth:
            - read:claims
    post:
      tags:
        - Eligibility determination API 
      summary: To get information of claim for person
      description: Response will contain claim details
      operationId: ''
      requestBody:
        description: send details of identifier
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EligibilityDeterminationRequest'     
        required: true
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EligibilityDeterminationResponse'     
        '400':
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '405':
          description: Method Not Allowed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'
        '422':
          description: Unprocessable Entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse' 
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HttpErrorResponse'                 
      security:
        - spmis_auth:
            - read:relationships

components:
  parameters:
    authorization:
      name: Authorization
      in: header
      required: true
      description: Access token which was issued after successful login with gateway auth server.
      schema:
        type: string
        example: Bearer <...>        
    version:
      in: header
      name: x-api-version
      schema:
        type: string
        example: "1.0.0"
      required: false
      description: If not provided use latest api version as default
    x-timestamp:
      in: header
      name: timestamp
      schema:
        type: string
        example: "2022-12-04T18:01:07+00:00"
      required: true
      description: Timestamp of request when it was sent , ideally it should be GMT
    x-hmac:
      in: header
      name: x-hmac
      schema:
        type: string
        example: "bd4a82cd319ababe57d0a822049ae8985029f82237509d3f091c82cbc7a6945c"
      required: true
      description: Signature created in combination of {x-message-id}+{x-timestamp:}+{x-sender-id}.This is usually encrypted string using HMAC-SHA-256 algorithm with the private key.
    x-registry-type:
      in: header
      name: x-registry-type
      schema:
        type: string
        enum: ['x-mosip','x-farmer','x-social','x-crvs','x-student']
      required: true
      description: This param used to decide which service to be called to retrieve data
    x-sender-id:
      in: header
      name: x-sender-id
      schema:
        type: string
        example: "Farmer help programme "
      required: true
      description: Information about requester , it may be some code of SP system
    x-message-id:
      in: header
      name: x-message-id
      schema:
        type: string
        format: uuid
        example: 0c96614c-7255-4774-b109-cd53ee859000
      required: true
      description: UUID string to be sent in request header for tracking of request
    x-async:
      in: header
      name: x-async
      schema:
        type: string
        example: true
      required: true
      description: Async param indicate that response to be sent immediate or in call back, if _true_ send data in response if _false_ just return HTTP status 202
    x-callbackendpoint:
      in: header
      name: x-callbackendpoint
      schema:
        type: string
        example: "https://{server_url}/notify"
      required: false
      description: If async response requested then this param to be supplied for receiving data in SP system, this is usually endpoint active in SP env

  schemas:
    AuthRequest:
      type: object
      properties:
        client_id:
          type: string
          example: 2fd153ab-86c8-45fb-990d-851840e46061
          description: The client id provided to SP system
        client_secret_key:
          type: string
          example: 8636abe2-bdfb-4238-8bff-200ed3652d1e
          description: The secret token provided along with client id
    LoginRequest:
      type: object
      properties:
        username:
          type: string
          example: spuser1
          description: Username of SP system
        password:
          type: string
          example: "Encrypted string"
          description: Encrypted password string
        spmisid:
          type: string
          example: spmis
          description: SPMIS identification string
        client_id:
          type: string
          example: 2fd153ab-86c8-45fb-990d-851840e46061
          description: The client id provided to SP system
        client_secret_key:
          type: string
          example: 8636abe2-bdfb-4238-8bff-200ed3652d1e
          description: The secret token provided along with client id
    AuthResponse:
      type: object
      properties:
        client_id:
          type: string
          example: 2fd153ab-86c8-45fb-990d-851840e46061
          description: The client id provided to SP system
        client_secret_key:
          type: string
          example: 8636abe2-bdfb-4238-8bff-200ed3652d1e
          description: The secret token provided along with client id
        tokenInfo:
          $ref: '#/components/schemas/TokenInfo'
    TokenInfo:
      type: object
      properties:
        access_token:
          type: string
        expires_in:
          type: string
        refresh_expires_in:
          type: string
        refresh_token:
          type: string
        token_type:
          type: string
        not-before-policy:
          type: string
        session_state:
          type: string
        scope:
          type: string
    SendOTPRequest:
      allOf: 
        - $ref: '#/components/schemas/IdentifierType'
        - $ref: '#/components/schemas/IdentifierValue'
    ValidateOTPRequest:
      allOf: 
        - $ref: '#/components/schemas/IdentifierType'
        - $ref: '#/components/schemas/IdentifierValue'
      type: object
      properties:
        otp:
          type: string
    SearchRequest:
      type: object
      example: '{"transaction_id":"0c96614c-7255-4774-b109-cd53ee851769","additionalFields":["contact","address","dob"],"filtergroups":[{"groupid":"A","operator-with-next-group":"and","fields":[{"fieldname":"identifier.type","operator":"contains","value":"NATIONAL_ID","nextfieldoperator":"and"},{"fieldname":"identifier.value","operator":"contains","value":"345678912","nextfieldoperator":""}]},{"groupid":"B","operator-with-next-group":"","fields":[{"fieldname":"name.first_name","operator":"contains","value":"john","nextfieldoperator":"or"},{"fieldname":"name.last_name","operator":"contains","value":"doe","nextfieldoperator":""}]}],"sortby":[{"fieldname":"name.first_name","order":"asc"}],"pagination":{"page_size":10,"page_number":5}}'
      properties:
        transaction_id:
          type: string
          example: 0c96614c-7255-4774-b109-cd53ee851769
        filtergroups:
          type: array
          items:
            oneOf:
              - $ref: '#/components/schemas/FilterGroupFarmerRegistry'
              - $ref: '#/components/schemas/FilterGroupCRVSRegistry'
        sortby:
          $ref: '#/components/schemas/Sort'
        pagination:
          type: object
          properties:
            page_size:
              type: number
              example: 10
            page_number:
              type: number
              example: 5  
    FilterGroupFarmerRegistry:
      type: object
      properties:
        groupid:
          type: string
          format: string
          example: "A"
        operator-with-next-group:
          type: string
          description: 'Operation with next group' 
          enum: ["and", "or"]
        fields:
          type: array
          items:
            anyOf:
              - $ref: '#/components/schemas/IdentifierTypeField'
              - $ref: '#/components/schemas/IdentifierValueField'
              - $ref: '#/components/schemas/NameField'
              - $ref: '#/components/schemas/CropTypeField'
              - $ref: '#/components/schemas/RegionField'
              - $ref: '#/components/schemas/FarmerTypeField'
    FilterGroupCRVSRegistry:
      type: object
      properties:
        groupid:
          type: string
          format: string
          example: "A"
        operator-with-next-group:
          type: string
          description: 'Operation with next group' 
          enum: ["and", "or"]
        fields:
          type: array
          items:
            anyOf:
              - $ref: '#/components/schemas/IdentifierTypeField'
              - $ref: '#/components/schemas/IdentifierValueField'
              - $ref: '#/components/schemas/RegionField'
              - $ref: '#/components/schemas/Repositories'
    Field:
      type: object
      required:
        - operator
        - nextfieldoperator
      properties: 
        operator:
          $ref: '#/components/schemas/FieldOperator'
        nextfieldoperator: 
          $ref: '#/components/schemas/GroupOperator'
    IdentifierTypeField:
      description: 'Search with identifier type'
      allOf: 
        - $ref: '#/components/schemas/Field'
        - type: object
          required:
            - fieldname
            - value
          properties: 
            fieldname:
              type: string
              example: 'identifier.type'
              enum: ['identifier.type']
            value: 
              type: string
              example: "NATIONAL_ID"
              enum: ['NATIONAL_ID','FARMER_ID']
    IdentifierValueField:
      description: 'Search with identifier value'
      allOf: 
        - $ref: '#/components/schemas/Field'
        - type: object
          required:
            - fieldname
            - value
          properties: 
            fieldname:
              type: string
              example: 'identifier.value'
              enum: ['identifier.value']
            value: 
              type: string
              example: "345678912"
              description: 'Any string that contains identifier, for example for identifier.type NATIONAL_ID value may be 345678912'
    NameField:
      description: 'Search with first name, HumanName is response object so fields of HumanName to be sent in search'
      allOf: 
        - $ref: '#/components/schemas/Field'
        - type: object
          required:
            - fieldname
            - value
          properties: 
            fieldname:
              type: string
              example: 'name.first_name'
              enum: ['name.first_name','name.last_name']
            value: 
              type: string
              example: "John"
              description: 'Search by first name or last name of human'
    CropTypeField:
      description: 'Search by crop type'    
      allOf: 
        - $ref: '#/components/schemas/Field'
        - type: object
          required:
            - fieldname
            - value
          properties: 
            fieldname:
              type: string
              example: 'croptype'
              enum: ['croptype']
            value: 
              type: string
              example: "kharif"
              enum: ['kharif','rabi','zaid']
              description: 'Search by crop type'
    RegionField:
      description: 'Search by region'        
      allOf: 
        - $ref: '#/components/schemas/Field'
        - type: object
          required:
            - fieldname
            - value
          properties: 
            fieldname:
              type: string
              example: 'region'
              enum: ['location']
            value: 
              type: string
              example: "SE- India"
              enum: ['SE- India','WEST - INDIA']
              description: 'Search by location'
    FarmerTypeField:
      allOf: 
        - $ref: '#/components/schemas/Field'
        - type: object
          required:
            - fieldname
            - value
          properties: 
            fieldname:
              type: string
              example: 'farmertype'
              enum: ['farmertype']
            value: 
              type: string
              example: "marginal"
              enum: ['owner','marginal']
              description: 'Search by farmer type'
    Repositories:
      allOf: 
        - $ref: '#/components/schemas/Field'
        - type: object
          required:
            - fieldname
            - value
          properties: 
            fieldname:
              type: string
              example: 'repository_type'
              enum: ['repository_type']
            value: 
              type: string
              example: "marginal"
              enum: ['Birth', 'Death', 'Marriage']
              description: 'Search by farmer type'
    IdentifierType:
      type: object
      properties:
        identifier_type:
          type: string
          enum: ['NATIONAL_ID','FARMER_REG_NO']
    IdentifierValue:
      type: object
      properties:
        identifier_value:
          type: string
          example: 345678912    
    FieldOperator:
      type: string
      enum:
        - or
        - and
        - contains
        - like
    GroupOperator:
      type: string
      enum:
        - or
        - and
    SupportedEligibility:
      type: object
      properties:
        claim_id:
          type: string
          format: string
        claim_type:
          type: string
          description: claim type 
          example: IS_A_FARMER
          enum: ['IS_A_FARMER']
        response_format:
          type: string
          enum: ['json','boolean','pdf','png','jpeg'] 
    EligibilityIsFarmerCheck:
      type: object
      properties:
        claim_id:
          type: string
          format: string
        claim_type:
          type: string
          description: claim type 
          example: IS_A_FARMER
          enum: ['IS_A_FARMER']
        response_format:
          type: string
          enum: ['json','boolean','pdf','png','jpeg'] 

    Sort:
      type: object
      properties:
        fieldname:
          type: string
          enum: [firstname,dob]
        order:
          type: string
          enum: ["asc","desc"]

    EligibilityDeterminationRequest:
      type: object
      properties:
        identifier:
          $ref: '#/components/schemas/Identifier'
        operations:
          type: array
          items:
            anyOf:
              - $ref: '#/components/schemas/EligibilityIsFarmerCheck'
        attestation:
          $ref: '#/components/schemas/EligibilityVerifier'
    EligibilityVerifier:
      type: object
      properties:
        institutation_code:
          type: string
          enum: ['GOV-AGRI-GUJ','GOV-AGRI-MH']
        institutation_name:
          type: string
          example: Department of Agricalture
    EligibilityDeterminationResponse:
      type: object
      properties:
        identifier:
          $ref: '#/components/schemas/Identifier'
        operations:
          type: array
          items:
            anyOf:
              - $ref: '#/components/schemas/EligibilityIsFarmerCheck'
        attestation:
          $ref: '#/components/schemas/EligibilityVerifier'
        issuance_metadata:
          type: object
          additionalProperties:
            type: string
          example:
            'FARMER_CERTIFICATE_NO': 'IN-GJ-01-23456'
            'FARMER_TYPE': 
              enum: ['owner','rented']
    ApiResponse:
      type: object
      properties:
        success:
          type: string
        return_message:
          type: string
        error_code:
          type: string
        transaction_id:
          type: string
          example: 0c96614c-7255-4774-b109-cd53ee859000
          description: The transaction_id received in request
        data: 
          type: array
          items:
            $ref: '#/components/schemas/FarmerInfo'
    HumanName:
      type: object
      properties:
        suffix:
          type: string
          example: PhD
        prefix:
          type: string
          example: Mr.
        first_name:
          type: string
          example: john
        middle_name:
          type: string
          example: doe
        last_name:
          type: string
          example: doe
    FarmerInfo:
      type: object
      properties:
        identifier:
          type: array
          items:
            allOf:
              - $ref: '#/components/schemas/Identifier'
              - $ref: '#/components/schemas/Identifier'
        name:
          $ref: '#/components/schemas/HumanName'
        location:
          type: string
        crop_type:
          type: string
          enum: ['Food Crops','Feed Crops','Fiber Crops','Oil Crops','Ornamental Crops','Industrial Crops']
        farmer_type:
          type: string
          enum: ['Marginal','Small','Medium','Large','Sharecropper','Tenant','Owner','landless']
        landsize:
          type: string
        contactno:
          type: string


    Identifier:
      type: object
      properties:
        type:
          type: string
          enum: ['NATIONAL_ID','FARMER_REG_NO']
        value:
          type: string
          example: 345678912

    VoucherGenerateRequest:
      type: object
      properties:
        request_id:
          type: string
          example: ''
        beneficiary_id:
          type: string
          example: ''
        program_id:
          type: string
          example: ''
        issuer_id:
          type: string
          example: ''
        requested_at:
          type: string
          example: ''
        payment_system:
          type: string
          example: ''
        status:
          type: string
          example: ''
        certificate_format:
          type: string
          example: ''
        callback_url:
          type: string
          example: ''
        amount:
          type: string
          example: ''
        currency:
          type: string
          example: ''
        expiration_date:
          type: string
          example: ''
        metadata:
          type: object
          example: '[{"{key1}": "{value1}"},{"{key2": "{value2}"}]'
    VoucherGenerateResponse:
      type: object
      properties:
        beneficiary_id:
          type: string
          example: ''
        program_id:
          type: string
          example: ''
        evouchar_number:
          type: string
          example: ''
        issuer_id:
          type: string
          example: ''
        generated_at:
          type: string
          example: ''
        payment_system:
          type: string
          example: ''
        status:
          type: string
          example: ''
        certificate_format:
          type: string
          example: ''
        certificate_url:
          type: string
          example: ''
        currency:
          type: string
          example: ''
        amount:
          type: string
          example: ''
        expiration_date:
          type: string
          example: ''
        metadata:
          type: string
          example: '[{"{key1}": "{value1}"},{"{key2": "{value2}"}]'

    VoucherIssueRequest:
      type: object
      properties:
        evouchar_number:
          type: string
          example: ''
        beneficiary_id:
          type: string
          example: ''
        issuer_id:
          type: string
          example: ''
        issued_at:
          type: string
          example: ''
        status:
          type: string
          example: ''
        certificate_url:
          type: string
          example: ''
        callback_url:
          type: string
          example: ''
        amount:
          type: string
          example: ''
        currency:
          type: string
          example: ''
        expiration_date:
          type: string
          example: ''
        metadata:
          type: string
          example: '[{"{key1}": "{value1}"},{"{key2": "{value2}"}]'

    VoucherIssueResponse:
      type: object
      properties:
        evouchar_number:
          type: string
          example: ''
        beneficiary_id:
          type: string
          example: ''
        issuer_id:
          type: string
          example: ''
        issued_at:
          type: string
          example: ''
        status:
          type: string
          example: ''
        amount:
          type: string
          example: ''
        currency:
          type: string
          example: ''
        expiration_date:
          type: string
          example: ''
        metadata:
          type: string
          example: '[{"{key1}": "{value1}"},{"{key2": "{value2}"}]'

    HttpErrorResponse:
      description: HTTP layer error details
      properties:
        error_code:
          type: string
        error_message:
          type: string
  securitySchemes:
    spmis_auth:            # arbitrary name for the security scheme
      type: http
      scheme: bearer
      bearerFormat: JWT

#    spmis_auth:
#      type: http
#      scheme: bearer
#      bearerFormat: jwt
#      flows:
#        implicit:
#          authorizationUrl: https://localhost:8081/oauth/authorize
#          scopes:
#            read:search: Allowed to perform search operation
#            read:claims: Read list of claims
