components:
  schemas:
    SubscriptionRequest:
      allOf:
        - $ref: './common.yaml#/components/schemas/SubscribeRequestObject'
      type: object
      properties:
        headers:
          properties:
            action:
              enum:
                - subscribe
              example: 'subscribe'      
        payload:
          type: object
          properties:
            registry_type:
              type: string
              example: ''
            event_type:
              type: array
              items:
                type: object
                allOf:
                  - $ref: '#/components/schemas/EventInfo'
            client_id:
              type: string
              example: ''
            custom_filter:
              type: object
              example:
                region: ''
    EventInfo:
      type: object
      properties:
        code:
          type: string
          example: ''
          enum: ["BIRTH_REGISTRATION", "DEATH_REGISTRATION","MARRIAGE_REGISTRATION","DIVORCE_REGISTRATION","DEMOGRAPHIC_UPDATE"]
        frequency:
          type: string
          example: ''
          enum: ['immediate','hourly','daily','weekly']
        response_fields:
          type: array
          example: '[]'
          items:
            type: string 
            enum: ['name', 'birthdate','birth_registration_number']
        callback_url:
          type: string
          example: ''
    SubscriptionResponse:
      allOf:
        - $ref: './responses.yaml#/components/schemas/BaseResponse'
      type: object
      properties:
        payload: 
          type: array
          items:
            type: object
            anyOf:
              - $ref: '#/components/schemas/SubscriptionList'
    SubscriptionList:
      type: object
      properties:
        subscription:
          type: array
          items:
            $ref: '#/components/schemas/SubscriptionObject'
    SubscriptionObject:
      type: object
      properties:
        event_code:
          type: string
          example: ''
          enum: ["BIRTH_REGISTRATION", "DEATH_REGISTRATION","MARRIAGE_REGISTRATION","DIVORCE_REGISTRATION","DEMOGRAPHIC_UPDATE"]
        registration_id:
          type: string
          example: ''
        status:
          type: string
          example: ''
    UnSubscribeRequest:
      allOf:
        - $ref: './common.yaml#/components/schemas/RequestObject'        
      type: object
      properties:
        payload:
          type: object
          properties:
            event_code:
              type: array
              items:
                type: string
              example: ["BIRTH_REGISTRATION", "DEATH_REGISTRATION","MARRIAGE_REGISTRATION","DIVORCE_REGISTRATION","DEMOGRAPHIC_UPDATE"]
              description: 'To un-subscribe this event send this code in subscription request'
            client_id:
              type: string
              example: ''
            reason:
              type: string  
              example: ''
    UnSubscribeResponse:
      allOf:
        - $ref: './responses.yaml#/components/schemas/BaseResponse'
      type: object
      properties:
        payload: 
          type: array
          items:
            $ref: '#/components/schemas/UnSubscribeObjectList'
    UnSubscribeObjectList:
      type: object
      properties:
        event:
          type: array
          items:
            $ref: '#/components/schemas/SubscriptionObject'            
   